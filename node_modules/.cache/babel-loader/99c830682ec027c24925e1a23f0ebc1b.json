{"ast":null,"code":"var _jsxFileName = \"/home/aidana/Game/game/src/components/MyPurchases.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport { ethers } from \"ethers\";\nimport { Row, Col, Card, Button } from 'react-bootstrap';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function MyPurchases(_ref) {\n  _s();\n\n  let {\n    marketplace,\n    nft,\n    account,\n    player,\n    setPlayer\n  } = _ref;\n  const [loading, setLoading] = useState(true);\n  const [purchases, setPurchases] = useState([]);\n\n  const loadPurchasedItems = async () => {\n    // Fetch purchased items from marketplace by quering Offered events with the buyer set as the user\n    const filter = marketplace.filters.Bought(null, null, null, null, null, account);\n    const results = await marketplace.queryFilter(filter); //Fetch metadata of each nft and add that to listedItem object.\n\n    const purchases = await Promise.all(results.map(async i => {\n      // fetch arguments from each result\n      i = i.args; // get uri url from nft contract\n\n      const uri = await nft.tokenURI(i.tokenId); // use uri to fetch the nft metadata stored on ipfs \n\n      const response = await fetch(uri);\n      const metadata = await response.json(); // get total price of item (item price + fee)\n\n      const totalPrice = await marketplace.getTotalPrice(i.itemId); // define listed item object\n\n      let purchasedItem = {\n        totalPrice,\n        price: i.price,\n        itemId: i.itemId,\n        name: metadata.name,\n        description: metadata.description,\n        image: metadata.image\n      };\n      return purchasedItem;\n    }));\n    setLoading(false);\n    setPurchases(purchases);\n  };\n\n  useEffect(() => {\n    loadPurchasedItems();\n    setPlayer();\n  }, []);\n  if (loading) return /*#__PURE__*/_jsxDEV(\"main\", {\n    style: {\n      padding: \"1rem 0\"\n    },\n    children: /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 5\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex justify-center\",\n    children: purchases.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-5 container\",\n      children: /*#__PURE__*/_jsxDEV(Row, {\n        xs: 1,\n        md: 2,\n        lg: 4,\n        className: \"g-4 py-5\",\n        children: purchases.map((item, idx) => /*#__PURE__*/_jsxDEV(Col, {\n          className: \"overflow-hidden\",\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            children: [/*#__PURE__*/_jsxDEV(Card.Img, {\n              variant: \"top\",\n              src: item.image\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 55,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Card.Footer, {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-grid\",\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  variant: \"primary\",\n                  size: \"lg\",\n                  children: \"Play\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 58,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 57,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 56,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 54,\n            columnNumber: 17\n          }, this)\n        }, idx, false, {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"main\", {\n      style: {\n        padding: \"1rem 0\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"No purchases\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 11\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 5\n  }, this);\n}\n\n_s(MyPurchases, \"+bT9nvXJXwVwMkewhHc+Eyc0m60=\");\n\n_c = MyPurchases;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyPurchases\");","map":{"version":3,"names":["useState","useEffect","ethers","Row","Col","Card","Button","MyPurchases","marketplace","nft","account","player","setPlayer","loading","setLoading","purchases","setPurchases","loadPurchasedItems","filter","filters","Bought","results","queryFilter","Promise","all","map","i","args","uri","tokenURI","tokenId","response","fetch","metadata","json","totalPrice","getTotalPrice","itemId","purchasedItem","price","name","description","image","padding","length","item","idx"],"sources":["/home/aidana/Game/game/src/components/MyPurchases.js"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport { ethers } from \"ethers\"\nimport { Row, Col, Card, Button } from 'react-bootstrap'\n\nexport default function MyPurchases({ marketplace, nft, account,player,setPlayer }) {\n\n  const [loading, setLoading] = useState(true)\n  const [purchases, setPurchases] = useState([])\n  const loadPurchasedItems = async () => {\n    // Fetch purchased items from marketplace by quering Offered events with the buyer set as the user\n    const filter =  marketplace.filters.Bought(null,null,null,null,null,account)\n    const results = await marketplace.queryFilter(filter)\n    //Fetch metadata of each nft and add that to listedItem object.\n    const purchases = await Promise.all(results.map(async i => {\n      // fetch arguments from each result\n      i = i.args\n      // get uri url from nft contract\n      const uri = await nft.tokenURI(i.tokenId)\n      // use uri to fetch the nft metadata stored on ipfs \n      const response = await fetch(uri)\n      const metadata = await response.json()\n      // get total price of item (item price + fee)\n      const totalPrice = await marketplace.getTotalPrice(i.itemId)\n      // define listed item object\n      let purchasedItem = {\n        totalPrice,\n        price: i.price,\n        itemId: i.itemId,\n        name: metadata.name,\n        description: metadata.description,\n        image: metadata.image\n      }\n      return purchasedItem\n    }))\n    setLoading(false)\n    setPurchases(purchases)\n  }\n  useEffect(() => {\n    loadPurchasedItems()\n    setPlayer()\n  }, [])\n  if (loading) return (\n    <main style={{ padding: \"1rem 0\" }}>\n      <h2>Loading...</h2>\n    </main>\n  )\n  return (\n    <div className=\"flex justify-center\">\n      {purchases.length > 0 ?\n        <div className=\"px-5 container\">\n          <Row xs={1} md={2} lg={4} className=\"g-4 py-5\">\n            {purchases.map((item, idx) => (\n              <Col key={idx} className=\"overflow-hidden\">\n                <Card>\n                  <Card.Img variant=\"top\" src={item.image} />\n                  <Card.Footer>\n                    <div className='d-grid'>\n                      <Button  variant=\"primary\" size=\"lg\">\n                        Play \n                      </Button>\n                    </div>\n                  </Card.Footer>\n                </Card>\n              </Col>\n            ))}\n          </Row>\n        </div>\n        : (\n          <main style={{ padding: \"1rem 0\" }}>\n            <h2>No purchases</h2>\n          </main>\n        )}\n    </div>\n  );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}